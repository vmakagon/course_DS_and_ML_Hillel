<div _ngcontent-tcw-c27="" class="homework__info"><div _ngcontent-tcw-c27="" class="homework__info-wrap"><div _ngcontent-tcw-c27="" class="homework__info-text"><!----><div _ngcontent-tcw-c27="" class="homework__number ng-star-inserted"> Домашнее задание 6 </div><!----><div _ngcontent-tcw-c27="" class="homework__date"> Добавлено: 17.07.2019 13:28 </div></div><!----></div><div _ngcontent-tcw-c27="" class="homework__title">Домашняя работа к уроку по нейронным сетям</div><div _ngcontent-tcw-c27="" class="homework__description wysiwyg-content wysiwyg-content--inverted"><p>1) Для начала давайте создадим модель, способную обучаться на мини-батчах произвольного размера (например batch_size = 32), Для этого вам может понадобиться:</p><p><br></p><p><br></p><ul><li>x = data.reshape(batch_size, 28*28)</li><li>w = torch.randn(28*28, 10, requires_grad=True)&nbsp;# теперь не 10х784, а 784х10</li><li>a_ = torch.mm(x, w/10) + b/10 # воспользуемся функцией torch.mm</li></ul><p><br></p><p># новая версия oneHot</p><p>def oneHot(a, oneHot_batch_size):</p><p>&nbsp;&nbsp;out = []</p><p>&nbsp;&nbsp;for i in a:</p><p>&nbsp;&nbsp;&nbsp;&nbsp;b = torch.zeros(10)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;b[i] = 1.</p><p>&nbsp;&nbsp;&nbsp;&nbsp;out.append(b)</p><p>&nbsp;&nbsp;out = torch.cat(out)</p><p>&nbsp;&nbsp;out = out.reshape(oneHot_batch_size, 10)</p><p>&nbsp;&nbsp;return out</p><p><br></p><p>#обучение стоит начинать с</p><p>for _ in range(20):</p><p>&nbsp;&nbsp;tot_loss = 0</p><p>&nbsp;&nbsp;for data, target in train_loader:</p><p>&nbsp;&nbsp;&nbsp;&nbsp;this_batch_size = data.shape[0]</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;x = data.reshape(this_batch_size, 28*28)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;y = oneHot(target, this_batch_size)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;# и т.д.</p><p><br></p><p># проверка станет такой</p><p>cnt = 0</p><p>for data, target in test_loader:</p><p>&nbsp;&nbsp;this_batch_size = data.shape[0]</p><p>&nbsp;&nbsp;&nbsp;</p><p>&nbsp;&nbsp;x = data.reshape(this_batch_size, 28*28)</p><p>&nbsp;&nbsp;y = oneHot(target, this_batch_size)</p><p>&nbsp;&nbsp;# тут 2 строчки: модель + активация</p><p>&nbsp;&nbsp;&nbsp;</p><p>&nbsp;&nbsp;for i in range(this_batch_size):</p><p>&nbsp;&nbsp;&nbsp;&nbsp;if y_[i].argmax() == target[i]:</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt+=1</p><p><br></p><p><br></p><p>Сделать замеры времени и выводы о скорости обучения batch_size=32 в сравнении с batch_size=1</p><p>На самом деле вырастет и точность, но для этой задачи это не будет заметно.</p><p><br></p><p>Дальше работаем уже с версией для batch_size=32</p><p><br></p><p>2) Необходимо создать двухслойную нейронную сеть (784 - 32 - 10) и решить при помощи решить задачу классификации mnist, сравнить точность с моделью 784 - 10)</p><p>Сделать выводы</p><p><br></p><p>3) Необходимо создать трехслойную нейронную сеть (784 - 64 - 32 - 10) и решить при помощи решить задачу классификации fashion-mnist, сравнить точность с моделью 784 - 32 - 10 и моделью 784 - 10)</p><p>Сделать выводы</p><p><br></p><p>4) ** Необходимо создать трехслойную нейронную сеть (3072 - 128 - 32 - 10) и решить при помощи решить задачу классификации CIFAR10, сравнить точность с моделью 3072 - 32 - 10 и моделью 3072 - 10)</p><p>Сделать выводы</p><p><br></p><p>датасеты брать из torch.utils.data.DataLoader(datasets.</p></div><div _ngcontent-tcw-c27=""><!----><!----><!----></div></div>